<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Knob Component Test - Harmony Design System</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
      background: #0a0a0a;
      color: #e0e0e0;
    }
    
    h1 {
      color: #4a9eff;
      margin-bottom: 0.5rem;
    }
    
    .subtitle {
      color: #888;
      margin-bottom: 2rem;
    }
    
    .test-section {
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 8px;
      padding: 2rem;
      margin-bottom: 2rem;
    }
    
    .test-section h2 {
      margin-top: 0;
      color: #4a9eff;
      font-size: 1.25rem;
    }
    
    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 2rem;
      margin-top: 1.5rem;
    }
    
    .test-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }
    
    .test-item label {
      font-size: 0.875rem;
      color: #888;
      text-align: center;
    }
    
    .value-display {
      font-family: 'Courier New', monospace;
      font-size: 0.875rem;
      color: #4a9eff;
      background: #0a0a0a;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      min-width: 100px;
      text-align: center;
    }
    
    .controls {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    
    button {
      background: #2a2a2a;
      border: 1px solid #444;
      color: #e0e0e0;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.875rem;
    }
    
    button:hover {
      background: #333;
      border-color: #4a9eff;
    }
    
    button:active {
      background: #1a1a1a;
    }
    
    .event-log {
      background: #0a0a0a;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 1rem;
      max-height: 200px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
    }
    
    .event-entry {
      padding: 0.25rem 0;
      border-bottom: 1px solid #222;
    }
    
    .event-type {
      color: #4a9eff;
      font-weight: bold;
    }
    
    .event-value {
      color: #66ff66;
    }
    
    .pass {
      color: #66ff66;
    }
    
    .info {
      background: #1a3a5a;
      border-left: 4px solid #4a9eff;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>Knob Component Test</h1>
  <p class="subtitle">Testing all states and interactions - Harmony Design System</p>
  
  <div class="test-section">
    <h2>Basic States</h2>
    <div class="test-grid">
      <div class="test-item">
        <harmony-knob id="knob-default" value="0.5" label="Default"></harmony-knob>
        <label>Default (0.5)</label>
        <div class="value-display" id="value-default">0.50</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-min" value="0" label="Minimum"></harmony-knob>
        <label>Minimum (0.0)</label>
        <div class="value-display" id="value-min">0.00</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-max" value="1" label="Maximum"></harmony-knob>
        <label>Maximum (1.0)</label>
        <div class="value-display" id="value-max">1.00</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-disabled" value="0.5" label="Disabled" disabled></harmony-knob>
        <label>Disabled</label>
        <div class="value-display" id="value-disabled">0.50</div>
      </div>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Custom Ranges</h2>
    <div class="test-grid">
      <div class="test-item">
        <harmony-knob id="knob-range1" value="50" min="0" max="100" step="1" label="0-100"></harmony-knob>
        <label>Range: 0-100, Step: 1</label>
        <div class="value-display" id="value-range1">50</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-range2" value="0" min="-1" max="1" step="0.1" label="-1 to 1"></harmony-knob>
        <label>Range: -1 to 1, Step: 0.1</label>
        <div class="value-display" id="value-range2">0.0</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-range3" value="440" min="20" max="20000" step="1" label="Frequency"></harmony-knob>
        <label>Frequency: 20-20000 Hz</label>
        <div class="value-display" id="value-range3">440</div>
      </div>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Sensitivity Test</h2>
    <div class="test-grid">
      <div class="test-item">
        <harmony-knob id="knob-sens1" value="0.5" sensitivity="0.001" label="Low Sensitivity"></harmony-knob>
        <label>Low Sensitivity (0.001)</label>
        <div class="value-display" id="value-sens1">0.50</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-sens2" value="0.5" sensitivity="0.005" label="Normal Sensitivity"></harmony-knob>
        <label>Normal Sensitivity (0.005)</label>
        <div class="value-display" id="value-sens2">0.50</div>
      </div>
      
      <div class="test-item">
        <harmony-knob id="knob-sens3" value="0.5" sensitivity="0.01" label="High Sensitivity"></harmony-knob>
        <label>High Sensitivity (0.01)</label>
        <div class="value-display" id="value-sens3">0.50</div>
      </div>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Programmatic Control</h2>
    <div class="test-item">
      <harmony-knob id="knob-program" value="0.5" label="Programmatic"></harmony-knob>
      <div class="value-display" id="value-program">0.50</div>
      <div class="controls">
        <button onclick="setKnobValue('knob-program', 0)">Set 0</button>
        <button onclick="setKnobValue('knob-program', 0.25)">Set 0.25</button>
        <button onclick="setKnobValue('knob-program', 0.5)">Set 0.5</button>
        <button onclick="setKnobValue('knob-program', 0.75)">Set 0.75</button>
        <button onclick="setKnobValue('knob-program', 1)">Set 1</button>
      </div>
    </div>
  </div>
  
  <div class="test-section">
    <h2>Event Monitoring</h2>
    <div class="info">
      <strong>Instructions:</strong> Interact with any knob above. Events will be logged below.
      <ul>
        <li><strong>knob-input:</strong> Fires during drag (high frequency)</li>
        <li><strong>knob-change:</strong> Fires on release, wheel, or keyboard</li>
      </ul>
    </div>
    <div class="event-log" id="event-log">
      <div class="event-entry">Waiting for events...</div>
    </div>
    <button onclick="clearEventLog()" style="margin-top: 1rem;">Clear Log</button>
  </div>
  
  <div class="test-section">
    <h2>Accessibility Test</h2>
    <div class="info">
      <strong>Keyboard Controls:</strong>
      <ul>
        <li>Arrow Up/Right: Increase by step</li>
        <li>Arrow Down/Left: Decrease by step</li>
        <li>Page Up: Increase by 10x step</li>
        <li>Page Down: Decrease by 10x step</li>
        <li>Home: Set to minimum</li>
        <li>End: Set to maximum</li>
      </ul>
      <p class="pass">✓ All knobs are keyboard accessible with Tab navigation</p>
      <p class="pass">✓ All knobs have proper ARIA labels and roles</p>
    </div>
  </div>
  
  <script type="module">
    import { HarmonyKnob } from './knob.js';
    
    // Update value displays
    function updateValueDisplay(knobId, value) {
      const display = document.getElementById(`value-${knobId.replace('knob-', '')}`);
      if (display) {
        const knob = document.getElementById(knobId);
        const decimals = knob.getAttribute('step')?.includes('.') ? 2 : 0;
        display.textContent = value.toFixed(decimals);
      }
    }
    
    // Setup event listeners for all knobs
    document.querySelectorAll('harmony-knob').forEach(knob => {
      knob.addEventListener('knob-input', (e) => {
        updateValueDisplay(knob.id, e.detail.value);
        logEvent('knob-input', knob.id, e.detail.value);
      });
      
      knob.addEventListener('knob-change', (e) => {
        updateValueDisplay(knob.id, e.detail.value);
        logEvent('knob-change', knob.id, e.detail.value);
      });
    });
    
    // Event logging
    let eventCount = 0;
    const maxEvents = 50;
    
    window.logEvent = function(type, source, value) {
      const log = document.getElementById('event-log');
      if (eventCount === 0) {
        log.innerHTML = '';
      }
      
      const entry = document.createElement('div');
      entry.className = 'event-entry';
      entry.innerHTML = `
        <span class="event-type">${type}</span> 
        from <strong>${source}</strong>: 
        <span class="event-value">${value.toFixed(3)}</span>
      `;
      
      log.insertBefore(entry, log.firstChild);
      eventCount++;
      
      // Limit log size
      if (eventCount > maxEvents) {
        log.removeChild(log.lastChild);
        eventCount = maxEvents;
      }
    };
    
    window.clearEventLog = function() {
      const log = document.getElementById('event-log');
      log.innerHTML = '<div class="event-entry">Waiting for events...</div>';
      eventCount = 0;
    };
    
    // Programmatic control
    window.setKnobValue = function(knobId, value) {
      const knob = document.getElementById(knobId);
      if (knob) {
        knob.value = value;
      }
    };
    
    console.log('✓ Knob component test page loaded');
    console.log('✓ All knobs initialized');
    console.log('→ Try dragging, scrolling, or using keyboard controls');
  </script>
</body>
</html>