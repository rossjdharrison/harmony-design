<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Harmony Gradient - Test Page</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
      background: #f5f5f5;
    }

    h1 {
      color: #333;
      margin-bottom: 2rem;
    }

    h2 {
      color: #666;
      margin-top: 2rem;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }

    .test-section {
      background: white;
      padding: 2rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .gradient-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 1rem;
    }

    .gradient-demo {
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
    }

    .gradient-demo harmony-gradient {
      height: 200px;
    }

    .gradient-label {
      padding: 0.75rem;
      background: #f9f9f9;
      border-top: 1px solid #e0e0e0;
      font-size: 0.875rem;
      color: #666;
    }

    .gradient-label code {
      background: #e8e8e8;
      padding: 0.125rem 0.25rem;
      border-radius: 3px;
      font-size: 0.8rem;
    }

    .controls {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .controls button {
      padding: 0.5rem 1rem;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.875rem;
    }

    .controls button:hover {
      background: #5568d3;
    }

    .event-log {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 1rem;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 0.875rem;
      max-height: 200px;
      overflow-y: auto;
      margin-top: 1rem;
    }

    .event-log .event {
      margin-bottom: 0.5rem;
      padding: 0.25rem;
      border-left: 3px solid #667eea;
      padding-left: 0.5rem;
    }

    .event-log .event.error {
      border-left-color: #f44336;
    }

    .with-content {
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 2rem;
      font-weight: bold;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .performance-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .stat-card {
      background: #f9f9f9;
      padding: 1rem;
      border-radius: 4px;
      border-left: 4px solid #667eea;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #333;
    }

    .stat-label {
      font-size: 0.875rem;
      color: #666;
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¨ Harmony Gradient - Test Suite</h1>

  <div class="test-section">
    <h2>Linear Gradients</h2>
    <div class="gradient-grid">
      <div class="gradient-demo">
        <harmony-gradient 
          type="linear" 
          angle="180deg"
          stops='[{"color": "#667eea", "position": "0%"}, {"color": "#764ba2", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Vertical</strong><br>
          <code>angle="180deg"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="linear" 
          angle="45deg"
          stops='[{"color": "#f093fb", "position": "0%"}, {"color": "#f5576c", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Diagonal</strong><br>
          <code>angle="45deg"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="linear" 
          angle="90deg"
          stops='[{"color": "#4facfe", "position": "0%"}, {"color": "#00f2fe", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Horizontal</strong><br>
          <code>angle="90deg"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="linear" 
          angle="135deg"
          stops='[{"color": "#fa709a", "position": "0%"}, {"color": "#fee140", "position": "50%"}, {"color": "#30cfd0", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Multi-stop</strong><br>
          <code>3 color stops</code>
        </div>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Radial Gradients</h2>
    <div class="gradient-grid">
      <div class="gradient-demo">
        <harmony-gradient 
          type="radial" 
          shape="circle"
          stops='[{"color": "#667eea", "position": "0%"}, {"color": "#764ba2", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Circle</strong><br>
          <code>shape="circle"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="radial" 
          shape="ellipse"
          stops='[{"color": "#f093fb", "position": "0%"}, {"color": "#f5576c", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Ellipse</strong><br>
          <code>shape="ellipse"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="radial" 
          shape="circle"
          position="top left"
          stops='[{"color": "#4facfe", "position": "0%"}, {"color": "#00f2fe", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Positioned</strong><br>
          <code>position="top left"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="radial" 
          shape="circle"
          size="closest-side"
          stops='[{"color": "#fa709a", "position": "0%"}, {"color": "#fee140", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Sized</strong><br>
          <code>size="closest-side"</code>
        </div>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Conic Gradients</h2>
    <div class="gradient-grid">
      <div class="gradient-demo">
        <harmony-gradient 
          type="conic" 
          angle="0deg"
          stops='[{"color": "#667eea", "position": "0%"}, {"color": "#764ba2", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Basic Conic</strong><br>
          <code>angle="0deg"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="conic" 
          angle="45deg"
          stops='[{"color": "#f093fb", "position": "0%"}, {"color": "#f5576c", "position": "50%"}, {"color": "#f093fb", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Rotated</strong><br>
          <code>angle="45deg"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="conic" 
          angle="0deg"
          position="top right"
          stops='[{"color": "#4facfe", "position": "0%"}, {"color": "#00f2fe", "position": "100%"}]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Positioned</strong><br>
          <code>position="top right"</code>
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          id="rainbow-conic"
          type="conic" 
          angle="0deg"
          stops='[
            {"color": "#ff0000", "position": "0%"},
            {"color": "#ffff00", "position": "16.67%"},
            {"color": "#00ff00", "position": "33.33%"},
            {"color": "#00ffff", "position": "50%"},
            {"color": "#0000ff", "position": "66.67%"},
            {"color": "#ff00ff", "position": "83.33%"},
            {"color": "#ff0000", "position": "100%"}
          ]'>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Rainbow</strong><br>
          <code>7 color stops</code>
        </div>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>With Content Overlay</h2>
    <div class="gradient-grid">
      <div class="gradient-demo">
        <harmony-gradient 
          type="linear" 
          angle="135deg"
          stops='[{"color": "#667eea", "position": "0%"}, {"color": "#764ba2", "position": "100%"}]'>
          <div class="with-content">OVERLAY</div>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Slotted Content</strong><br>
          Content over gradient
        </div>
      </div>

      <div class="gradient-demo">
        <harmony-gradient 
          type="radial" 
          shape="circle"
          stops='[{"color": "rgba(255,255,255,0.2)", "position": "0%"}, {"color": "rgba(0,0,0,0.8)", "position": "100%"}]'>
          <div class="with-content">VIGNETTE</div>
        </harmony-gradient>
        <div class="gradient-label">
          <strong>Transparent Stops</strong><br>
          Vignette effect
        </div>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Interactive Controls</h2>
    <div class="gradient-demo">
      <harmony-gradient 
        id="dynamic-gradient"
        type="linear" 
        angle="180deg"
        stops='[{"color": "#667eea", "position": "0%"}, {"color": "#764ba2", "position": "100%"}]'>
      </harmony-gradient>
    </div>
    <div class="controls">
      <button id="btn-linear">Linear</button>
      <button id="btn-radial">Radial</button>
      <button id="btn-conic">Conic</button>
      <button id="btn-rotate">Rotate 45Â°</button>
      <button id="btn-random">Random Colors</button>
      <button id="btn-animate">Animate</button>
    </div>
  </div>

  <div class="test-section">
    <h2>Performance Metrics</h2>
    <div class="performance-stats">
      <div class="stat-card">
        <div class="stat-value" id="stat-gradients">0</div>
        <div class="stat-label">Gradients Rendered</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="stat-events">0</div>
        <div class="stat-label">Events Fired</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="stat-errors">0</div>
        <div class="stat-label">Errors</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="stat-fps">60</div>
        <div class="stat-label">Target FPS</div>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Event Log</h2>
    <div class="event-log" id="event-log">
      <div class="event">Waiting for events...</div>
    </div>
  </div>

  <script type="module">
    import './harmony-gradient.js';

    // Performance tracking
    let gradientCount = 0;
    let eventCount = 0;
    let errorCount = 0;

    // Update stats
    function updateStats() {
      document.getElementById('stat-gradients').textContent = gradientCount;
      document.getElementById('stat-events').textContent = eventCount;
      document.getElementById('stat-errors').textContent = errorCount;
    }

    // Log events
    function logEvent(type, detail) {
      const log = document.getElementById('event-log');
      const event = document.createElement('div');
      event.className = `event ${type === 'error' ? 'error' : ''}`;
      event.textContent = `[${new Date().toLocaleTimeString()}] ${type}: ${JSON.stringify(detail)}`;
      log.insertBefore(event, log.firstChild);
      
      // Keep only last 20 events
      while (log.children.length > 20) {
        log.removeChild(log.lastChild);
      }
    }

    // Listen for gradient events
    document.addEventListener('gradient-ready', (e) => {
      gradientCount++;
      eventCount++;
      updateStats();
      logEvent('gradient-ready', e.detail);
    });

    document.addEventListener('gradient-error', (e) => {
      errorCount++;
      eventCount++;
      updateStats();
      logEvent('gradient-error', e.detail);
    });

    // Interactive controls
    const dynamicGradient = document.getElementById('dynamic-gradient');
    let currentAngle = 180;
    let animationId = null;

    document.getElementById('btn-linear').addEventListener('click', () => {
      dynamicGradient.setAttribute('type', 'linear');
      logEvent('user-action', { action: 'set-type', value: 'linear' });
    });

    document.getElementById('btn-radial').addEventListener('click', () => {
      dynamicGradient.setAttribute('type', 'radial');
      dynamicGradient.setAttribute('shape', 'circle');
      logEvent('user-action', { action: 'set-type', value: 'radial' });
    });

    document.getElementById('btn-conic').addEventListener('click', () => {
      dynamicGradient.setAttribute('type', 'conic');
      logEvent('user-action', { action: 'set-type', value: 'conic' });
    });

    document.getElementById('btn-rotate').addEventListener('click', () => {
      currentAngle = (currentAngle + 45) % 360;
      dynamicGradient.setAttribute('angle', `${currentAngle}deg`);
      logEvent('user-action', { action: 'rotate', angle: currentAngle });
    });

    document.getElementById('btn-random').addEventListener('click', () => {
      const randomColor = () => {
        const h = Math.floor(Math.random() * 360);
        const s = 70 + Math.floor(Math.random() * 30);
        const l = 50 + Math.floor(Math.random() * 20);
        return `hsl(${h}, ${s}%, ${l}%)`;
      };

      const stops = [
        { color: randomColor(), position: '0%' },
        { color: randomColor(), position: '100%' }
      ];

      dynamicGradient.setStops(stops);
      logEvent('user-action', { action: 'random-colors', stops });
    });

    document.getElementById('btn-animate').addEventListener('click', () => {
      if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
        logEvent('user-action', { action: 'stop-animation' });
        return;
      }

      let angle = 0;
      const animate = () => {
        angle = (angle + 2) % 360;
        dynamicGradient.setAttribute('angle', `${angle}deg`);
        animationId = requestAnimationFrame(animate);
      };
      
      animate();
      logEvent('user-action', { action: 'start-animation' });
    });

    // Performance test - measure render time
    console.log('ðŸŽ¨ Harmony Gradient Test Suite Loaded');
    console.log('Performance target: < 16ms per frame for 60fps');
    
    const perfStart = performance.now();
    const allGradients = document.querySelectorAll('harmony-gradient');
    const perfEnd = performance.now();
    
    console.log(`âœ… Rendered ${allGradients.length} gradients in ${(perfEnd - perfStart).toFixed(2)}ms`);
    console.log(`âš¡ Average: ${((perfEnd - perfStart) / allGradients.length).toFixed(2)}ms per gradient`);

    // Initial stats update
    updateStats();
  </script>
</body>
</html>