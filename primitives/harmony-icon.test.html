<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HarmonyIcon Component Test</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
      background: #f5f5f5;
    }

    .test-section {
      background: white;
      padding: 2rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    h1 {
      color: #333;
      border-bottom: 2px solid #007bff;
      padding-bottom: 0.5rem;
    }

    h2 {
      color: #555;
      margin-top: 0;
    }

    .icon-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .icon-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #fafafa;
    }

    .icon-label {
      font-size: 0.875rem;
      color: #666;
      text-align: center;
    }

    .size-demo {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-top: 1rem;
    }

    .color-demo {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }

    .test-log {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      padding: 1rem;
      margin-top: 1rem;
      font-family: monospace;
      font-size: 0.875rem;
      max-height: 200px;
      overflow-y: auto;
    }

    .test-log-entry {
      padding: 0.25rem 0;
      border-bottom: 1px solid #e9ecef;
    }

    .test-log-entry:last-child {
      border-bottom: none;
    }

    .test-log-entry.success {
      color: #28a745;
    }

    .test-log-entry.error {
      color: #dc3545;
    }

    .performance-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }

    .stat-card {
      background: #e7f3ff;
      padding: 1rem;
      border-radius: 4px;
      text-align: center;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: #007bff;
    }

    .stat-label {
      font-size: 0.875rem;
      color: #666;
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>
  <h1>üé® HarmonyIcon Component Test Suite</h1>

  <div class="test-section">
    <h2>Basic Icons (24px default)</h2>
    <div class="icon-grid">
      <div class="icon-item">
        <harmony-icon icon="play" label="Play"></harmony-icon>
        <span class="icon-label">play</span>
      </div>
      <div class="icon-item">
        <harmony-icon icon="pause" label="Pause"></harmony-icon>
        <span class="icon-label">pause</span>
      </div>
      <div class="icon-item">
        <harmony-icon icon="stop" label="Stop"></harmony-icon>
        <span class="icon-label">stop</span>
      </div>
      <div class="icon-item">
        <harmony-icon icon="record" label="Record"></harmony-icon>
        <span class="icon-label">record</span>
      </div>
      <div class="icon-item">
        <harmony-icon icon="volume" label="Volume"></harmony-icon>
        <span class="icon-label">volume</span>
      </div>
      <div class="icon-item">
        <harmony-icon icon="mute" label="Mute"></harmony-icon>
        <span class="icon-label">mute</span>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Size Variations</h2>
    <div class="size-demo">
      <harmony-icon icon="play" size="16" label="Small play"></harmony-icon>
      <span>16px</span>
      <harmony-icon icon="play" size="24" label="Medium play"></harmony-icon>
      <span>24px</span>
      <harmony-icon icon="play" size="32" label="Large play"></harmony-icon>
      <span>32px</span>
      <harmony-icon icon="play" size="48" label="XL play"></harmony-icon>
      <span>48px</span>
      <harmony-icon icon="play" size="64" label="XXL play"></harmony-icon>
      <span>64px</span>
    </div>
  </div>

  <div class="test-section">
    <h2>Color Variations</h2>
    <div class="color-demo">
      <harmony-icon icon="play" size="32" color="#007bff" label="Blue play"></harmony-icon>
      <harmony-icon icon="play" size="32" color="#28a745" label="Green play"></harmony-icon>
      <harmony-icon icon="play" size="32" color="#dc3545" label="Red play"></harmony-icon>
      <harmony-icon icon="play" size="32" color="#ffc107" label="Yellow play"></harmony-icon>
      <harmony-icon icon="play" size="32" color="#6f42c1" label="Purple play"></harmony-icon>
    </div>
  </div>

  <div class="test-section">
    <h2>Dynamic Updates</h2>
    <div style="display: flex; gap: 1rem; align-items: center;">
      <harmony-icon id="dynamic-icon" icon="play" size="48" label="Dynamic icon"></harmony-icon>
      <div>
        <button onclick="changeIcon()">Change Icon</button>
        <button onclick="changeSize()">Change Size</button>
        <button onclick="changeColor()">Change Color</button>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Performance Stats</h2>
    <div class="performance-stats">
      <div class="stat-card">
        <div class="stat-value" id="render-time">-</div>
        <div class="stat-label">Render Time (ms)</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="icon-count">-</div>
        <div class="stat-label">Icons Rendered</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="memory-usage">-</div>
        <div class="stat-label">Memory (KB)</div>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Event Log</h2>
    <div class="test-log" id="event-log">
      <div class="test-log-entry">Waiting for events...</div>
    </div>
  </div>

  <!-- Inline SVG sprite for testing -->
  <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <symbol id="play" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z"/>
      </symbol>
      <symbol id="pause" viewBox="0 0 24 24">
        <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
      </symbol>
      <symbol id="stop" viewBox="0 0 24 24">
        <path d="M6 6h12v12H6z"/>
      </symbol>
      <symbol id="record" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="8"/>
      </symbol>
      <symbol id="volume" viewBox="0 0 24 24">
        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
      </symbol>
      <symbol id="mute" viewBox="0 0 24 24">
        <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
      </symbol>
    </defs>
  </svg>

  <script type="module">
    import { HarmonyIcon } from './harmony-icon.js';

    // Test configuration
    const icons = ['play', 'pause', 'stop', 'record', 'volume', 'mute'];
    const colors = ['#007bff', '#28a745', '#dc3545', '#ffc107', '#6f42c1'];
    const sizes = [16, 24, 32, 48, 64];
    let currentIconIndex = 0;
    let currentSizeIndex = 2;
    let currentColorIndex = 0;

    // Event logging
    const eventLog = document.getElementById('event-log');
    function logEvent(message, type = 'info') {
      const entry = document.createElement('div');
      entry.className = `test-log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      eventLog.appendChild(entry);
      eventLog.scrollTop = eventLog.scrollHeight;
    }

    // Listen to icon events
    document.addEventListener('icon-load', (e) => {
      logEvent(`Icon loaded: ${e.detail.icon}`, 'success');
    });

    document.addEventListener('icon-error', (e) => {
      logEvent(`Icon error: ${e.detail.message}`, 'error');
    });

    // Dynamic update functions
    window.changeIcon = function() {
      currentIconIndex = (currentIconIndex + 1) % icons.length;
      const icon = document.getElementById('dynamic-icon');
      icon.icon = icons[currentIconIndex];
      logEvent(`Changed icon to: ${icons[currentIconIndex]}`);
    };

    window.changeSize = function() {
      currentSizeIndex = (currentSizeIndex + 1) % sizes.length;
      const icon = document.getElementById('dynamic-icon');
      icon.size = sizes[currentSizeIndex];
      logEvent(`Changed size to: ${sizes[currentSizeIndex]}px`);
    };

    window.changeColor = function() {
      currentColorIndex = (currentColorIndex + 1) % colors.length;
      const icon = document.getElementById('dynamic-icon');
      icon.color = colors[currentColorIndex];
      logEvent(`Changed color to: ${colors[currentColorIndex]}`);
    };

    // Performance measurement
    function measurePerformance() {
      const startTime = performance.now();
      const iconCount = document.querySelectorAll('harmony-icon').length;
      const renderTime = performance.now() - startTime;

      document.getElementById('render-time').textContent = renderTime.toFixed(2);
      document.getElementById('icon-count').textContent = iconCount;

      // Memory measurement (if available)
      if (performance.memory) {
        const memoryUsage = (performance.memory.usedJSHeapSize / 1024).toFixed(0);
        document.getElementById('memory-usage').textContent = memoryUsage;
      } else {
        document.getElementById('memory-usage').textContent = 'N/A';
      }

      // Verify performance budget (16ms per frame)
      if (renderTime > 16) {
        logEvent(`‚ö†Ô∏è Performance warning: Render time ${renderTime.toFixed(2)}ms exceeds 16ms budget`, 'error');
      } else {
        logEvent(`‚úì Performance check passed: ${renderTime.toFixed(2)}ms`, 'success');
      }
    }

    // Run tests after DOM loads
    window.addEventListener('load', () => {
      logEvent('Test suite initialized', 'success');
      
      // Update sprite path for all icons to use inline SVG
      document.querySelectorAll('harmony-icon').forEach(icon => {
        icon.sprite = '#';
      });

      setTimeout(measurePerformance, 100);
      
      // Run performance test every 5 seconds
      setInterval(measurePerformance, 5000);
    });

    // Accessibility test
    setTimeout(() => {
      const icons = document.querySelectorAll('harmony-icon');
      let accessibilityPassed = true;
      
      icons.forEach(icon => {
        const svg = icon.shadowRoot.querySelector('svg');
        const hasRole = svg.hasAttribute('role');
        const hasAriaLabel = svg.hasAttribute('aria-label') || svg.hasAttribute('aria-hidden');
        
        if (!hasRole || !hasAriaLabel) {
          accessibilityPassed = false;
          logEvent(`‚ö†Ô∏è Accessibility issue in icon: ${icon.icon}`, 'error');
        }
      });

      if (accessibilityPassed) {
        logEvent('‚úì All accessibility checks passed', 'success');
      }
    }, 500);
  </script>
</body>
</html>