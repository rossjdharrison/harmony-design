<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Focus Tracker Web Component Example</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }

    h1 {
      color: #333;
      margin-bottom: 30px;
    }

    .demo-section {
      background: white;
      padding: 30px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>Focus Tracker in Web Components</h1>

  <div class="demo-section">
    <h2>Interactive Card Component</h2>
    <interactive-card title="Click me!" description="This card tracks all interaction states"></interactive-card>
  </div>

  <script type="module">
    import { FocusTracker } from '../core/focus-tracker.js';

    /**
     * Interactive card component demonstrating FocusTracker usage
     */
    class InteractiveCard extends HTMLElement {
      constructor() {
        super();
        this.attachShadow({ mode: 'open' });
      }

      connectedCallback() {
        this.render();
        this.setupFocusTracking();
      }

      disconnectedCallback() {
        if (this.focusTracker) {
          this.focusTracker.destroy();
        }
      }

      render() {
        const title = this.getAttribute('title') || 'Card';
        const description = this.getAttribute('description') || '';

        this.shadowRoot.innerHTML = `
          <style>
            :host {
              display: block;
            }

            .card {
              padding: 20px;
              border: 2px solid #ddd;
              border-radius: 8px;
              cursor: pointer;
              transition: all 0.2s;
              background: white;
              outline: none;
            }

            .card.focused {
              border-color: #007bff;
              box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
            }

            .card.hovered {
              border-color: #0056b3;
              transform: translateY(-2px);
              box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            }

            .card.active {
              transform: translateY(0);
              box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            }

            .card.disabled {
              opacity: 0.6;
              cursor: not-allowed;
              background: #f5f5f5;
            }

            .title {
              font-size: 20px;
              font-weight: bold;
              margin: 0 0 10px 0;
              color: #333;
            }

            .description {
              margin: 0;
              color: #666;
            }

            .state-indicator {
              margin-top: 15px;
              padding: 10px;
              background: #f8f9fa;
              border-radius: 4px;
              font-size: 12px;
              font-family: monospace;
            }
          </style>
          <div class="card" tabindex="0" role="button">
            <h3 class="title">${title}</h3>
            <p class="description">${description}</p>
            <div class="state-indicator"></div>
          </div>
        `;
      }

      setupFocusTracking() {
        const card = this.shadowRoot.querySelector('.card');
        const indicator = this.shadowRoot.querySelector('.state-indicator');

        this.focusTracker = new FocusTracker({
          element: card,
          onStateChange: (state) => {
            // Update classes
            const classes = this.focusTracker.getClassNames();
            card.className = 'card ' + classes.join(' ');

            // Update state indicator
            const stateText = Object.entries(state)
              .map(([key, value]) => `${key}: ${value}`)
              .join(' | ');
            indicator.textContent = stateText;
          }
        });
      }
    }

    customElements.define('interactive-card', InteractiveCard);
  </script>
</body>
</html>