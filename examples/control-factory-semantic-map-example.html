<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Control Factory Semantic Map - Example</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      padding: 2rem;
      background: #1a1a1a;
      color: #e0e0e0;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      color: #00d4ff;
      margin-bottom: 2rem;
    }
    
    .section {
      background: #2a2a2a;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .section h2 {
      color: #00d4ff;
      margin-top: 0;
      font-size: 1.2rem;
    }
    
    .controls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .control-item {
      background: #1a1a1a;
      border: 1px solid #404040;
      border-radius: 4px;
      padding: 1rem;
    }
    
    .control-item label {
      display: block;
      font-size: 0.9rem;
      color: #a0a0a0;
      margin-bottom: 0.5rem;
    }
    
    .control-item .semantic-type {
      font-size: 0.8rem;
      color: #00d4ff;
      font-family: monospace;
    }
    
    .stats {
      background: #1a1a1a;
      border: 1px solid #404040;
      border-radius: 4px;
      padding: 1rem;
      font-family: monospace;
      font-size: 0.9rem;
    }
    
    .stats pre {
      margin: 0;
      white-space: pre-wrap;
    }
    
    .validation {
      padding: 1rem;
      border-radius: 4px;
      margin-bottom: 1rem;
    }
    
    .validation.valid {
      background: #1a3a1a;
      border: 1px solid #2a6a2a;
      color: #4afa4a;
    }
    
    .validation.invalid {
      background: #3a1a1a;
      border: 1px solid #6a2a2a;
      color: #fa4a4a;
    }
    
    button {
      background: #00d4ff;
      color: #1a1a1a;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      margin-right: 0.5rem;
    }
    
    button:hover {
      background: #00b4df;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Control Factory Semantic Map - Example</h1>
    
    <div class="section">
      <h2>Component Registration Validation</h2>
      <div id="validation-status"></div>
    </div>
    
    <div class="section">
      <h2>Semantic Type Statistics</h2>
      <div class="stats">
        <pre id="statistics"></pre>
      </div>
    </div>
    
    <div class="section">
      <h2>Audio Parameter Controls</h2>
      <div class="controls-grid" id="audio-controls"></div>
    </div>
    
    <div class="section">
      <h2>Time Parameter Controls</h2>
      <div class="controls-grid" id="time-controls"></div>
    </div>
    
    <div class="section">
      <h2>Discrete Controls</h2>
      <div class="controls-grid" id="discrete-controls"></div>
    </div>
    
    <div class="section">
      <h2>Custom Registration Example</h2>
      <button id="register-custom">Register Custom Type</button>
      <button id="create-custom">Create Custom Control</button>
      <div id="custom-output" style="margin-top: 1rem;"></div>
    </div>
  </div>
  
  <script type="module">
    import {
      getComponentForSemanticType,
      createControlForSemanticType,
      validateComponentRegistration,
      getMapStatistics,
      getAllSemanticTypes,
      registerSemanticType
    } from '../harmony-web-components/control-factory-semantic-map.js';
    
    // Display validation status
    function displayValidation() {
      const validation = validateComponentRegistration();
      const statusDiv = document.getElementById('validation-status');
      
      if (validation.valid) {
        statusDiv.innerHTML = `
          <div class="validation valid">
            ✓ All components are registered
          </div>
        `;
      } else {
        statusDiv.innerHTML = `
          <div class="validation invalid">
            ⚠ Missing components: ${validation.missing.join(', ')}
            <br><small>Note: This is expected in this demo as not all components are implemented yet.</small>
          </div>
        `;
      }
    }
    
    // Display statistics
    function displayStatistics() {
      const stats = getMapStatistics();
      const statsDiv = document.getElementById('statistics');
      
      statsDiv.textContent = JSON.stringify(stats, null, 2);
    }
    
    // Create control examples
    function createControlExamples() {
      const audioTypes = ['gain', 'volume', 'pan', 'cutoff', 'resonance'];
      const timeTypes = ['attack', 'decay', 'sustain', 'release', 'delay'];
      const discreteTypes = ['toggle', 'mute', 'solo', 'bypass'];
      
      const audioContainer = document.getElementById('audio-controls');
      const timeContainer = document.getElementById('time-controls');
      const discreteContainer = document.getElementById('discrete-controls');
      
      function createControlItem(semanticType, container) {
        const componentTag = getComponentForSemanticType(semanticType);
        const item = document.createElement('div');
        item.className = 'control-item';
        
        item.innerHTML = `
          <label>
            ${semanticType.charAt(0).toUpperCase() + semanticType.slice(1)}
            <div class="semantic-type">${semanticType} → ${componentTag}</div>
          </label>
          <div style="height: 60px; display: flex; align-items: center; justify-content: center; background: #0a0a0a; border-radius: 4px;">
            <span style="color: #606060; font-size: 0.8rem;">${componentTag}</span>
          </div>
        `;
        
        container.appendChild(item);
      }
      
      audioTypes.forEach(type => createControlItem(type, audioContainer));
      timeTypes.forEach(type => createControlItem(type, timeContainer));
      discreteTypes.forEach(type => createControlItem(type, discreteContainer));
    }
    
    // Custom registration example
    document.getElementById('register-custom').addEventListener('click', () => {
      try {
        registerSemanticType('custom-modulator', 'harmony-custom-modulator');
        const output = document.getElementById('custom-output');
        output.innerHTML = `
          <div class="validation valid">
            ✓ Registered: custom-modulator → harmony-custom-modulator
          </div>
        `;
      } catch (error) {
        const output = document.getElementById('custom-output');
        output.innerHTML = `
          <div class="validation invalid">
            ✗ Error: ${error.message}
          </div>
        `;
      }
    });
    
    document.getElementById('create-custom').addEventListener('click', () => {
      try {
        const element = createControlForSemanticType('custom-modulator', {
          label: 'Custom Modulator',
          value: '0.5'
        });
        
        const output = document.getElementById('custom-output');
        output.innerHTML = `
          <div class="validation valid">
            ✓ Created element: &lt;${element.tagName.toLowerCase()}&gt;
            <br>Attributes: label="${element.getAttribute('label')}", value="${element.getAttribute('value')}"
          </div>
        `;
      } catch (error) {
        const output = document.getElementById('custom-output');
        output.innerHTML = `
          <div class="validation invalid">
            ✗ Error: ${error.message}
          </div>
        `;
      }
    });
    
    // Initialize
    displayValidation();
    displayStatistics();
    createControlExamples();
    
    console.log('Control Factory Semantic Map Example loaded');
    console.log('All semantic types:', getAllSemanticTypes());
  </script>
</body>
</html>